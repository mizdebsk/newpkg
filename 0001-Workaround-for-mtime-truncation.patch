From 840cc2be11f74f0c2232513d7797ad85fdf307ed Mon Sep 17 00:00:00 2001
From: Michael Simacek <msimacek@redhat.com>
Date: Tue, 3 Mar 2015 15:13:08 +0100
Subject: [PATCH] Workaround for mtime truncation

---
 .../main/java/io/takari/incrementalbuild/spi/FilesystemWorkspace.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/incrementalbuild/src/main/java/io/takari/incrementalbuild/spi/FilesystemWorkspace.java b/incrementalbuild/src/main/java/io/takari/incrementalbuild/spi/FilesystemWorkspace.java
index 3cc418b..d1a626c 100644
--- a/incrementalbuild/src/main/java/io/takari/incrementalbuild/spi/FilesystemWorkspace.java
+++ b/incrementalbuild/src/main/java/io/takari/incrementalbuild/spi/FilesystemWorkspace.java
@@ -43,7 +43,7 @@ public class FilesystemWorkspace implements Workspace {
     if (!isPresent(file)) {
       return ResourceStatus.REMOVED;
     }
-    if (length == file.length() && lastModified == file.lastModified()) {
+    if (length == file.length() && lastModified / 1000 == file.lastModified() / 1000) {
       return ResourceStatus.UNMODIFIED;
     }
     return ResourceStatus.MODIFIED;
-- 
2.1.0

